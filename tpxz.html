<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>卡片生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-top: 40px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .controls {
            flex: 1;
            min-width: 300px;
        }
        
        .preview {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group h3 {
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.2rem;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 10px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .color-picker {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-picker input {
            flex: 1;
            height: 45px;
            margin-bottom: 0;
        }
        
        .color-picker span {
            width: 60px;
            text-align: center;
        }
        
        .preview-container {
            width: 100%;
            height: 250px; /* 108:54比例 */
            border: 2px dashed #ddd;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            background: white;
            margin-bottom: 20px;
            padding: 15px;
        }
        
        #cardPreview {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: white;
            padding: 15px;
            position: relative;
        }
        
        .flight-info {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 12px;
            color: #000;
        }
        
        .time-info {
            font-size: 18px;
            margin-bottom: 20px;
            color: #000;
        }
        
        .welcome-text {
            font-size: 22px;
            margin-bottom: 15px;
            color: #000;
            line-height: 1.5;
        }
        
        .guest-name {
            font-size: 32px; /* 增大人物姓名字体 */
            font-weight: bold;
            color: #d35400; /* 默认颜色 */
            display: inline-block;
            margin: 0 5px;
            padding: 2px 8px;
            border-radius: 5px;
            background-color: #fff3e0; /* 添加背景色使其更突出 */
        }
        
        .hotel-info {
            font-size: 16px;
            color: #000;
            line-height: 1.4;
            max-width: 90%;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .generate-btn, .download-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .download-btn {
            background: #27ae60;
        }
        
        .generate-btn:hover {
            background: #2980b9;
        }
        
        .download-btn:hover {
            background: #219653;
        }
        
        .ratio-info {
            text-align: center;
            margin-top: 10px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .flight-info {
                font-size: 18px;
            }
            
            .welcome-text {
                font-size: 18px;
            }
            
            .guest-name {
                font-size: 24px;
            }
            
            .hotel-info {
                font-size: 14px;
            }
            
            .preview-container {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>贵宾接待卡片生成器</h1>
            <p class="subtitle">&nbsp;</p>
        </header>
        
        <div class="main-content">
            <div class="controls">
                <div class="control-group">
                    <h3>航班信息</h3>
                    <input type="text" id="flightNumber" placeholder="航班号" value="cz6039">
                </div>
                
                <div class="control-group">
                    <h3>时间信息</h3>
                    <input type="text" id="flightTime" placeholder="时间" value="21:20">
                    <input type="date" id="flightDate" value="2025-10-01">
                </div>
                
                <div class="control-group">
                    <h3>贵宾信息</h3>
                    <input type="text" id="guestName" placeholder="贵宾姓名" value="王女士">
                    <input type="text" id="destination" placeholder="目的地" value="格鲁吉亚">
                </div>
                
                <div class="control-group">
                    <h3>人物颜色</h3>
                    <div class="color-picker">
                        <span>颜色:</span>
                        <input type="color" id="guestColor" value="#000000">
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>酒店信息</h3>
                    <input type="text" id="hotelName" placeholder="酒店名称" value="Tbilisi Chambers, Trademark Collection by Wyndham">
                    <input type="text" id="hotelLocation" placeholder="酒店地点" value="第比利斯">
                </div>
            </div>
            
            <div class="preview">
                <h3>预览</h3>
                <div class="preview-container">
      <div id="cardPreview">
                        <div class="flight-info">航班号：<span id="previewFlight">cz6039</span></div>
                        <div class="time-info">时间：<span id="previewTime">21:20 (2025.10.01)</span></div>
                        <div class="welcome-text">欢迎" <span id="previewGuest" class="guest-name">王女士</span> "一行贵宾来<span id="previewDestination">格鲁吉亚</span></div>
                        <div class="hotel-info">Hotel: <span id="previewHotel">Tbilisi Chambers, Trademark Collection by Wyndham</span> <span id="previewLocation">第比利斯</span></div>
                    </div>
                </div>
                <p class="ratio-info">&nbsp;</p>
                
                <div class="action-buttons">
                    <button class="generate-btn" id="generateBtn">
                        <span>生成卡片</span>
                    </button>
                    <button class="download-btn" id="downloadBtn">
                        <span>下载图片</span>
                    </button>
                </div>
            </div>
        </div>
        
    <footer>
            <p>© 2025/10/1 贵卡片生成器</p>
      </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 获取所有输入元素
            const flightNumber = document.getElementById('flightNumber');
            const flightTime = document.getElementById('flightTime');
            const flightDate = document.getElementById('flightDate');
            const guestName = document.getElementById('guestName');
            const destination = document.getElementById('destination');
            const guestColor = document.getElementById('guestColor');
            const hotelName = document.getElementById('hotelName');
            const hotelLocation = document.getElementById('hotelLocation');
            
            // 获取所有预览元素
            const previewFlight = document.getElementById('previewFlight');
            const previewTime = document.getElementById('previewTime');
            const previewGuest = document.getElementById('previewGuest');
            const previewDestination = document.getElementById('previewDestination');
            const previewHotel = document.getElementById('previewHotel');
            const previewLocation = document.getElementById('previewLocation');
            
            // 获取按钮
            const generateBtn = document.getElementById('generateBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            
            // 格式化日期函数
            function formatDate(dateString) {
                const date = new Date(dateString);
                const year = date.getFullYear();
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const day = date.getDate().toString().padStart(2, '0');
                return `${year}.${month}.${day}`;
            }
            
            // 更新预览
            function updatePreview() {
                previewFlight.textContent = flightNumber.value;
                previewTime.textContent = `${flightTime.value} (${formatDate(flightDate.value)})`;
                previewGuest.textContent = guestName.value;
                previewDestination.textContent = destination.value;
                previewHotel.textContent = hotelName.value;
                previewLocation.textContent = hotelLocation.value;
                
                // 更新人物颜色
                previewGuest.style.color = guestColor.value;
            }
            
            // 初始化预览
            updatePreview();
            
            // 绑定事件
            flightNumber.addEventListener('input', updatePreview);
            flightTime.addEventListener('input', updatePreview);
            flightDate.addEventListener('input', updatePreview);
            guestName.addEventListener('input', updatePreview);
            destination.addEventListener('input', updatePreview);
            guestColor.addEventListener('input', updatePreview);
            hotelName.addEventListener('input', updatePreview);
            hotelLocation.addEventListener('input', updatePreview);
            
            // 生成卡片
            generateBtn.addEventListener('click', function() {
                updatePreview();
                alert('贵宾接待卡片已更新！');
            });
            
            // 下载图片
            downloadBtn.addEventListener('click', function() {
                // 创建canvas元素 - 使用108:54比例
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                
                // 设置canvas尺寸为1080x540 (108:54比例)
                canvas.width = 1080;
                canvas.height = 540;
                
                // 绘制白色背景
                context.fillStyle = '#ffffff';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                // 设置文字样式
                context.textAlign = 'center';
                context.fillStyle = '#000000';
                
                // 绘制航班信息
                context.font = 'bold 60px Helvetica, Arial, sans-serif';
                context.fillText(`航班号：${flightNumber.value}`, canvas.width / 2, 130);
                
                // 绘制时间信息
                context.font = '50px Helvetica, Arial, sans-serif';
                context.fillText(`时间：${flightTime.value} (${formatDate(flightDate.value)})`, canvas.width / 2, 220);
                
                // 绘制欢迎信息 - 人物姓名使用更大字体
                context.font = '55px Helvetica, Arial, sans-serif';
                const welcomeText1 = '欢迎"  ';
                const welcomeText2 = '  "一行贵宾来';
                const guestNameText = guestName.value;
                const destinationText = destination.value;
                
                // 计算各部分文本宽度
                const welcomeWidth1 = context.measureText(welcomeText1).width;
                const guestNameWidth = context.measureText(guestNameText).width;
                const welcomeWidth2 = context.measureText(welcomeText2).width;
                const destinationWidth = context.measureText(destinationText).width;
                
                const totalWidth = welcomeWidth1 + guestNameWidth + welcomeWidth2 + destinationWidth;
                const startX = (canvas.width - totalWidth) / 2;
                
                // 分别绘制各部分文本
                context.fillText(welcomeText1, startX + welcomeWidth1/2, 340);
                
                // 绘制人物姓名（更大更醒目，使用自定义颜色）
                context.font = 'bold 70px Helvetica, Arial, sans-serif';
                context.fillStyle = guestColor.value;
                context.fillText(guestNameText, startX + welcomeWidth1 + guestNameWidth/2, 340);
                
                // 恢复样式
                context.font = '55px Helvetica, Arial, sans-serif';
                context.fillStyle = '#000000';
                context.fillText(welcomeText2, startX + welcomeWidth1 + guestNameWidth + welcomeWidth2/2, 340);
                context.fillText(destinationText, startX + welcomeWidth1 + guestNameWidth + welcomeWidth2 + destinationWidth/2, 340);
                
                // 绘制酒店信息
                context.font = '40px Helvetica, Arial, sans-serif';
                
                // 处理长酒店名称换行
                const hotelText = `Hotel: ${hotelName.value} ${hotelLocation.value}`;
                const maxWidth = 1000;
                
                if (context.measureText(hotelText).width > maxWidth) {
                    const words = hotelText.split(' ');
                    let line = '';
                    let lines = [];
                    
                    for(let n = 0; n < words.length; n++) {
                        const testLine = line + words[n] + ' ';
                        if (context.measureText(testLine).width > maxWidth && n > 0) {
                            lines.push(line);
                            line = words[n] + ' ';
                        } else {
                            line = testLine;
                        }
                    }
                    lines.push(line);
                    
                    // 绘制多行文本
                    for(let i = 0; i < lines.length; i++) {
                        context.fillText(lines[i], canvas.width / 2, 430 + (i * 50));
                    }
                } else {
                    context.fillText(hotelText, canvas.width / 2, 430);
                }
                
                // 创建下载链接
                const dataURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = `贵宾接待卡片-${guestName.value}.png`;
                link.href = dataURL;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        });
    </script>
</body>
</html>